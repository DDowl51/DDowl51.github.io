import{g as A,f as V,V as P,u as Q,b as h,h as X,i as Z,j as K,p as ee,k as te,P as re,O as ne}from"./react-k3C6X3Ue.js";import{F as g,a as k,I as oe,B as E,C as N,S as ie,T as b,R as se,P as ae,L as ce,b as ue,c as le}from"./antd-CVHlxxsA.js";import{r as fe}from"./library-BKRPAIBe.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var C={exports:{}},m={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D;function de(){if(D)return m;D=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,o,i){var s=null;if(i!==void 0&&(s=""+i),o.key!==void 0&&(s=""+o.key),"key"in o){i={};for(var a in o)a!=="key"&&(i[a]=o[a])}else i=o;return o=i.ref,{$$typeof:t,type:r,key:s,ref:o!==void 0?o:null,props:i}}return m.Fragment=e,m.jsx=n,m.jsxs=n,m}var L;function pe(){return L||(L=1,C.exports=de()),C.exports}var c=pe(),he=fe();const v=A(he);function me(t){const e=new Date(t);e.setSeconds(0,0);const r=t.getMinutes()%5;let o;if(r!==0){const s=5-r;o=new Date(e.getTime()+s*60*1e3)}else t.getTime()>e.getTime()?o=new Date(e.getTime()+5*60*1e3):o=e;const i=o.getTime()-t.getTime();return Math.floor(i/1e3)}const ye=function(t,e,n){const r=function(f){return(f<15.5?"0":"")+Math.round(f).toString(16)},o=function(f){return parseInt(f,16)},i=function(f,S,Y){return S+1>=f.length&&(f=Array(S+1-f.length).join(Y)+f),f},s=v.enc.Hex.parse(t),a=Math.round(new Date().getTime()/1e3),u=i(r(Math.floor(a/n)),16,"0"),l=v.enc.Hex.parse(u),d=v.HmacSHA1(l,s).toString(v.enc.Hex),x=o(d.substring(d.length-1));let p=(o(d.substr(x*2,8))&o("7fffffff"))+"";return p=p.substring(p.length-e,p.length),p};function ge(t){const e="18601C601BFE3C606E60CC601F02";if(t.match(/^\d{6,10}$/)){let n="";for(let r=0;r<t.length;r++)n+="0"+t[r];return ye(n+e,8,300)}return""}const be={histories:[]},B=V({name:"key-history",initialState:be,reducers:{add:(t,e)=>{t.histories.length&&t.histories[t.histories.length-1].key===e.payload.key||t.histories.push(e.payload)},remove:(t,e)=>{const n=t.histories.findIndex(r=>r.key===e.payload.key);n!==-1&&t.histories.splice(n,1)},clear:t=>{t.histories=[]}}}),{add:xe,remove:Ae,clear:Ne}=B.actions,Se=B.reducer;function J(t,e){const n=new Date(t),r=n.getSeconds();return n.setSeconds(r+e),n}async function q(t,e=!0){await navigator.clipboard.writeText(t),e&&P.success("已复制到剪切板")}const _=300;function $(t){const e=Math.min(1,Math.max(0,t)),n={r:82,g:196,b:26},r={r:255,g:77,b:79},o=Math.round(n.r+(r.r-n.r)*e),i=Math.round(n.g+(r.g-n.g)*e),s=Math.round(n.b+(r.b-n.b)*e),a=u=>u.toString(16).padStart(2,"0");return`#${a(o)}${a(i)}${a(s)}`}function F(t){return[Math.max(Math.floor(t/60),0).toString().padStart(2,"0"),Math.max(t%60,0).toString().padStart(2,"0")]}const ve=()=>{const t=Q(),[e,n]=h.useState(""),[r,o]=h.useState(_),[i,s]=h.useState(-1),a=h.useCallback(async()=>{if(r<=0){await q("",!1),P.error("密码已过期, 请重新生成");return}const l=`单次密码: [${e}], 有效期至${J(new Date,r).toLocaleString()}`;await q(l)},[e,r]),u=l=>{if(!l.match(/^\d{6,10}$/)){P.error("请输入6-10位的数字");return}const d=ge(l);if(e===d){P.error(`${F(r).join("分")}秒后再试`);return}const x=new Date,p=me(x);t(xe({key:d,createDate:x,duration:p})),n(d),o(p),i!==-1&&clearInterval(i);const f=setInterval(()=>{o(S=>S-1)},1e3);s(f),setTimeout(()=>{clearInterval(f),u(l)},(r+1)*1e3)};return c.jsxs(g,{vertical:!0,style:{justifyContent:"space-between",paddingTop:"20px"},justify:"center",align:"center",children:[c.jsxs(k,{layout:"vertical",size:"large",onFinish:l=>u(l["admin-password"]),children:[c.jsx(k.Item,{style:{margin:0},label:"输入管理员密码",name:"admin-password",children:c.jsx(oe,{type:"password",pattern:"[0-9]{6,10}",inputMode:"numeric",minLength:6,maxLength:10})}),c.jsx(g,{justify:"center",style:{margin:"20px 0"},children:c.jsx(E,{htmlType:"submit",type:"primary",children:"生成密码"})})]}),e?c.jsx(N,{children:c.jsxs(ie,{direction:"vertical",align:"center",children:[c.jsxs(g,{align:"end",gap:8,children:[c.jsx(b.Text,{style:{fontWeight:"bold",fontSize:48,lineHeight:1,fontFamily:"Courier New"},children:e}),c.jsx(E,{size:"large",icon:c.jsx(se,{}),onClick:a})]}),c.jsx(ae,{size:280,percent:r/_*100,type:"circle",strokeColor:$(1-r/_),status:r<=0?"exception":"success",format:(l,d)=>d?"/":c.jsx(b,{style:{fontSize:48,fontWeight:"bold",color:$(1-r/_),fontFamily:"Courier New"},children:F(r).join(":")})})]})}):null]})},_e=()=>{const t=X(e=>e.keyHistory.histories);return c.jsx("div",{style:{overflowY:"scroll",height:"80vh"},children:c.jsx(ce,{dataSource:t.toReversed(),renderItem:e=>{const n=new Date(e.createDate),r=J(n,e.duration);return c.jsx(N,{children:c.jsxs(g,{gap:24,justify:"space-between",children:[c.jsx(b.Text,{style:{fontWeight:"bold",fontSize:32,lineHeight:1,fontFamily:"Courier New"},children:e.key}),c.jsxs(g,{vertical:!0,children:[c.jsxs(b.Text,{style:{fontSize:12},children:["生成：",n.toLocaleString()]}),c.jsxs(b.Text,{style:{fontSize:12},children:["过期：",r.toLocaleString()]})]})]})},e.key)}})})},we=[{key:"generate",label:"密码生成",children:c.jsx(ve,{})},{key:"history",label:"历史记录",children:c.jsx(_e,{})}];function je(){return c.jsx(ue,{tabBarStyle:{width:"100%",backgroundColor:"white",position:"fixed",bottom:0},animated:{tabPane:!0,inkBar:!0},size:"large",tabPosition:"bottom",items:we,centered:!0})}var y={},w={},j={},H;function Pe(){if(H)return j;H=1,j.__esModule=!0,j.default=o;function t(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(a){return typeof a}:t=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},t(i)}function e(){}var n={getItem:e,setItem:e,removeItem:e};function r(i){if((typeof self>"u"?"undefined":t(self))!=="object"||!(i in self))return!1;try{var s=self[i],a="redux-persist ".concat(i," test");s.setItem(a,"test"),s.getItem(a),s.removeItem(a)}catch{return!1}return!0}function o(i){var s="".concat(i,"Storage");return r(s)?self[s]:n}return j}var z;function Te(){if(z)return w;z=1,w.__esModule=!0,w.default=n;var t=e(Pe());function e(r){return r&&r.__esModule?r:{default:r}}function n(r){var o=(0,t.default)(r);return{getItem:function(s){return new Promise(function(a,u){a(o.getItem(s))})},setItem:function(s,a){return new Promise(function(u,l){u(o.setItem(s,a))})},removeItem:function(s){return new Promise(function(a,u){a(o.removeItem(s))})}}}return w}var W;function Re(){if(W)return y;W=1,y.__esModule=!0,y.default=void 0;var t=e(Te());function e(r){return r&&r.__esModule?r:{default:r}}var n=(0,t.default)("local");return y.default=n,y}var Me=Re();const Ce=A(Me),Ie=Z({keyHistory:Se}),Oe={key:"root",storage:Ce,blacklist:[]},ke=ee(Oe,Ie),G=K({reducer:ke,middleware:t=>t({serializableCheck:!1})});function T(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(n){return typeof n}:T=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},T(t)}function Ee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Le(t,e,n){return e&&De(t.prototype,e),t}function qe(t,e){return e&&(T(e)==="object"||typeof e=="function")?e:R(t)}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},I(t)}function R(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}function O(t,e){return O=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},O(t,e)}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var U=function(t){$e(e,t);function e(){var n,r;Ee(this,e);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return r=qe(this,(n=I(e)).call.apply(n,[this].concat(i))),M(R(r),"state",{bootstrapped:!1}),M(R(r),"_unsubscribe",void 0),M(R(r),"handlePersistorState",function(){var a=r.props.persistor,u=a.getState(),l=u.bootstrapped;l&&(r.props.onBeforeLift?Promise.resolve(r.props.onBeforeLift()).finally(function(){return r.setState({bootstrapped:!0})}):r.setState({bootstrapped:!0}),r._unsubscribe&&r._unsubscribe())}),r}return Le(e,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),e}(h.PureComponent);M(U,"defaultProps",{children:null,loading:null});const Fe=te(G);le.createRoot(document.getElementById("root")).render(c.jsx(h.StrictMode,{children:c.jsx(re,{store:G,children:c.jsxs(U,{loading:null,persistor:Fe,children:[c.jsx(ne,{}),c.jsx(je,{})]})})}));
